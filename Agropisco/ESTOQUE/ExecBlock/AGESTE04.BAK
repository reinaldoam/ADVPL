#INCLUDE "Protheus.ch"
#INCLUDE "TbiConn.ch"

User Function AGESTE04

  Local cQry:= ""
                                                                
  //- Protocolo 52/91 - Anexo I
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_GRTRIB='010',B1_TS='565' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND (B1_POSIPI IN "
  cQry += "( "
  cQry += "'73071920','82073000','82071900','84021100','84021200','84021900','84022000','84041010','84042000','84051000','84061000', "
  cQry += "'84068100','84068200','84101100','84101200','84101300','84109000','84128000','84137010','84137080','84137090','84148012', "
  cQry += "'84148013','84148019','84148031','84148032','84148033','84148038','84148039','84161000','84162010','84162090','84163000', "
  cQry += "'84169000','84171010','84171020','84171090','84172000','84178010','84178020','84178090','84186910','84186999','84186920', "
  cQry += "'84193200','84193900','84194010','84194020','84194090','84195010','84195021','84195022','84195029','84195090','84196000', "
  cQry += "'84198110','84198190','84198911','84198919','84198920','84198930','84198940','84198999','84201010','84201090','84209100', "
  cQry += "'84211110','84211190','84211290','84211910','84211990','84213990','84222000','84223010','84223021','84223022','84223023', "
  cQry += "'84223029','84224010','84224020','84224030','84224090','84232000','84233011','84233019','84233090','84238110','84238190', "
  cQry += "'84238190','84238200','84238900','84238200','84242000','84243010','84243020','84243030','84243090','84248990','84251100', "
  cQry += "'84251910','84251990','84253110','84253190','84253910','84253990','84261100','84262000','84263000','84269900','84279000', "
  cQry += "'84281000','84282010','84282090','84283100','84283200','84283300','84283910','84283920','84283930','84283990','84342010', "
  cQry += "'84342090','84351000','84371000','84378010','84378090','84381000','84382011','84382019','84382090','84383000','84384000', "
  cQry += "'84385000','84386000','84388020','84388090','84391010','84391020','84391030','84391090','84392000','84393010','84393020', "
  cQry += "'84393030','84393090','84401011','84401019','84401020','84401090','84411010','84411090','84412000','84413010','84413090', "
  cQry += "'84414000','84418000','84423010','84423020','84431110','84431190','84431200','84431310','84431321','84431329','84431390', "
  cQry += "'84431500','84431600','84431710','84431790','84431990','84439191','84439192','84439199','84433910','84440010','84440020', "
  cQry += "'84440090','84451110','84451120','84451190','84451200','84451300','84451910','84451921','84451922','84451923','84451924', "
  cQry += "'84451925','84451926','84451927','84451929','84452000','84453010','84453090','84454011','84454012','84454018','84454019', "
  cQry += "'84454021','84454029','84454031','84454039','84454040','84454090','84459010','84459020','84459030','84459040','84459090', "
  cQry += "'84461010','84461090','84462100','84462900','84463010','84463020','84463030','84463040','84463090','84471100','84471200', "
  cQry += "'84472021','84472029','84472030','84479010','84479020','84479090','84481110','84481120','84481190','84481900','84490010') " 
  cQry += "OR B1_POSIPI LIKE '846729%') " 
  TCSQLExec(cQry)

  //- Protocolo 52/91 - Anexo I
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_GRTRIB='010',B1_TS='565' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND (B1_POSIPI IN "
  cQry += "( "
  cQry += "'73071920','82073000','82071900','84021100','84021200','84021900','84022000','84041010','84042000','84051000','84061000','84068100','84068200', "
  cQry += "'84101100','84101200','84101300','84109000','84128000','84137010','84137080','84137090','84148012','84148013','84148019','84148031','84148032', "
  cQry += "'84148033','84148038','84148039','84161000','84162010','84162090','84163000','84169000','84171010','84171020','84171090','84172000','84178010', "
  cQry += "'84178020','84178090','84186910','84186999','84186920','84193200','84193900','84194010','84194020','84194090','84195010','84195021','84195022', "
  cQry += "'84195029','84195090','84196000','84198110','84198190','84198911','84198919','84198920','84198930','84198940','84198999','84201010','84201090', "
  cQry += "'84209100','84211110','84211190','84211290','84211910','84211990','84213990','84222000','84223010','84223021','84223022','84223023','84223029', "
  cQry += "'84224010','84224020','84224030','84224090','84232000','84233011','84233019','84233090','84238110','84238190','84238190','84238200','84238900', "
  cQry += "'84238200','84242000','84243010','84243020','84243030','84243090','84248990','84251100','84251910','84251990','84253110','84253190','84253910', "
  cQry += "'84253990','84261100','84262000','84263000','84269900','84279000','84281000','84282010','84282090','84283100','84283200','84283300','84283910', "
  cQry += "'84283920','84283930','84283990','84342010','84342090','84351000','84371000','84378010','84378090','84381000','84382011','84382019','84382090', "
  cQry += "'84383000','84384000','84385000','84386000','84388020','84388090','84391010','84391020','84391030','84391090','84392000','84393010','84393020', "
  cQry += "'84393030','84393090','84401011','84401019','84401020','84401090','84411010','84411090','84412000','84413010','84413090','84414000','84418000', "
  cQry += "'84423010','84423020','84431110','84431190','84431200','84431310','84431321','84431329','84431390','84431400','84431500','84431600','84431710', "
  cQry += "'84431790','84431990','84439191','84439192','84439199','84433910','84440010','84440020','84440090','84451110','84451120','84451190','84451200', "
  cQry += "'84451300','84451910','84451921','84451922','84451923','84451924','84451925','84451926','84451927','84451929','84452000','84453010','84453090', "
  cQry += "'84454011','84454012','84454018','84454019','84454021','84454029','84454031','84454039','84454040','84454090','84459010','84459020','84459030', "
  cQry += "'84459040','84459090','84461010','84461090','84462100','84462900','84463010','84463020','84463030','84463040','84463090','84471100','84471200', "  
  cQry += "'84472021','84472029','84472030','84479010','84479020','84479090','84481110','84481120','84481190','84481900','84490010','84490020','84490080', "
  cQry += "'84501100','84501200','84501900','84502010','84502090','84511000','84512100','84512910','84512990','84513010','84513091','84513099','84514010', "
  cQry += "'84514021','84514029','84514090','84515010','84515020','84515090','84518000','84522110','84522120','84522190','84522910','84522921','84522922', "
  cQry += "'84522923','84522929','84522924','84522925','84531010','84531090','84532000','84538000','84541000','84542010','84542090','84543010','84543020', "
  cQry += "'84543090','84549010','84549090','84551000','84552110','84552190','84552210','84552290','84553010','84553020','84553090','84559000','84563011', "
  cQry += "'84563019','84563090','84571000','84572010','84572090','84573010','84573090','84581110','84581191','84581199','84581910','84581990','84589100', "
  cQry += "'84589900','84591000','84592110','84592191','84592199','84592900','84593100','84593900','84594000','84595100','84595900','84596100','84596900', "
  cQry += "'84597000','84601100','84601900','84602100','84602900','84603100','84603900','84604011','84604019','84604091','84604099','84609011','84609012', "
  cQry += "'84609019','84609090','84612010','84612090','84613010','84613090','84614010','84614091','84614099','84615010','84615020','84615090','84619010', "
  cQry += "'84619090','84621011','84621019','84621090','84622100','84622900','84623100','84623910','84623990','84624100','84624900','84629111','84629191', "
  cQry += "'84629119','84629199','84629910','84629920','84629990','84631010','84631090','84632010','84632091','84632099','84633000','84639010','84639090', "
  cQry += "'84641000','84642010','84642021','84642029','84642090','84649011','84649019','84649090','84651000','84659110','84659120','84659190','84659211', "
  cQry += "'84659219','84659290','84659310','84659390','84659400','84659511','84659512','84659591','84659592','84659600','84659900','84662010','84663000', "
  cQry += "'84669100','84669200','84669319','84669320','84669330','84669340','84669350','84669360','84669410','84669420','84669430','84669490','84671110', "
  cQry += "'84671190','84671900','84678100','84678900','84681000','84682000','84688010','84688090','84741000','84742010','84742090','84743100','84743200', "
  cQry += "'84743900','84748010','84748090','84751000','84752100','84752910','84752990','84771011','84771019','84771021','84771029','84771091','84771099', "
  cQry += "'84772010','84772090','84773010','84773090','84774010','84774090','84775100','84775911','84775919','84775990','84778010','84778090','84781090', "
  cQry += "'84792000','84793000','84794000','84798110','84798190','84798922','84798999','84801000','84803000','84804100','84804910','84804990','84805000', "
  cQry += "'84806000','84807100','84807900','84818093','84818095','84818097','84818099','84834010','84834090','85044010','85044090','85141010','85142011', "
  cQry += "'85142020','85143011','85143021','85143090','85149000','85152100','85153110','85153190','85153900','85158010','85158090','85433000','86071919', "
  cQry += "'90241090','85437099','85437099'))"
  TCSQLExec(cQry)

  // Protocolo 52/91 - ANEXO II
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_GRTRIB='011',B1_TS='566' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND B1_GRTRIB <> '010' "
  cQry += "AND (B1_POSIPI IN "
  cQry += "( "
  cQry += "'39239000','76129090','73101090','73102910','73102990','74199990','39251000','73090010','84198999','84798940','94060091', "
  cQry += "'94060092','44219000','73269090','73269090','87087090','82011000','82012000','82013000','82014000','82015000','82016000', "
  cQry += "'82019000','84128000','84145990','84148011','84148019','84148090','84193100','84238200','84248111','84248119','84248121', "
  cQry += "'84248129','84272090','84279000','84306990','84321000','84322900','84323010','84323090','84324000','84328000','84329000', "
  cQry += "'84322100','84331100','84331900','84332010','84332090','84333000','84334000','84335100','84335200','84335300','84335911', "
  cQry += "'84335919','84335990','84336010','84336021','84336029','84336090','84339090','84678900','84341000','84361000','84362100', "
  cQry += "'84362900','84368000','84369100','84369900','84678100','85269100','87011000','87019090','84138100','87162000','87168000', "
  cQry += "'88022010','88023010','88031000','88032000','88033000','88039000','90278014','94060010'))"
  TCSQLExec(cQry)
  
  // Protocolo 52/91 - ANEXO II
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_GRTRIB='011',B1_TS='566' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND B1_GRTRIB <> '010' "
  cQry += "AND (B1_POSIPI IN "
  cQry += "( "
  cQry += "'39239000','76129090','73101090','73102910','73102990','74199990','39251000','73090010','84198999','84798940','94060091','94060092','44219000', "
  cQry += "'73269090','73269090','87087090','82011000','82012000','82013000','82014000','82015000','82016000','82019000','84128000','84145990','84148011', "
  cQry += "'84148019','84148090','84193100','84238200','84248111','84248119','84248121','84248129','84272090','84279000','84306990','84321000','84322900', "
  cQry += "'84323010','84323090','84324000','84328000','84329000','84322100','84331100','84331900','84332010','84332090','84333000','84334000','84335100', "
  cQry += "'84335200','84335300','84335911','84335919','84335990','84336010','84336021','84336029','84336090','84339090','84678900','84341000','84361000', "
  cQry += "'84362100','84362900','84368000','84369100','84369900','84678100','85269100','87011000','87019090','84138100','87162000','87168000','88022010', "
  cQry += "'88023010','88031000','88032000','88033000','88039000','90278014','94060010'))"
  TCSQLExec(cQry)

  //- Adequação ao CEST
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_TS='525' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND B1_TS NOT IN('565','566') "
  cQry += "AND (B1_POSIPI IN "         
  cQry += "( "  
  cQry += "'38151210','38151290','39181000','39233000','39263000','59100000','40169300','40161010','40169990','57050000',"
  cQry += "'59039000','59090000','65061000','70071100','70072100','70091000','70140000','73110000','73110000','80070090','83021000',"
  cQry += "'83023000','84141000','90321010','90321090','90322000','73229010','22089000','22089000','22089000','22084000','22060090',"
  cQry += "'22089000','22082000','22060090','22089000','22085000','22060090','22089000','22087000','22082000','22084000','22060090',"
  cQry += "'22089000','22089000','22086000','22089000','22089000','22082000','22060010','22060090','22089000','22011000','22011000',"
  cQry += "'22011000','22011000','22011000','22011000','22021000','22029000','22029000','21069010','22029000','22029000','21069090',"
  cQry += "'21069090','22029000','22029000','22021000','22029000','22030000','22029000','22030000','27101259','27101251','27101919',"
  cQry += "'27101911','27111910','27111100','27112100','38260000','27102000','27160000','40169990','44170010','44170090','82022000',"
  cQry += "'82029100','82090011','90172000','90179090','90251190','90259010','90259090','85041000','85437099','38245000','32149000',"
  cQry += "'39251000','39251000','39252000','39253000','68101900','69010000','69060000','69120000','70071900','70072900','72142000'," 
  cQry += "'73089010','72142000','73089010','72171090','73083000','73084000','73084000','73089090','73130000','73151100','73151290',"
  cQry += "'73158200','74111010','74182000','76071990','76090000','76152000','83024100','83021000','28289011','28289019','32064100',"
  cQry += "'38089419','34012090','34012090','34022000','34022000','34022000','38099190','39241000','39249000','68053010','68053090',"
  cQry += "'22089000','73231000','74130000','30066000','30066000','30051090','30051090','40151100','40151900','40141000','39269090',"
  cQry += "'90189099','48131000','39241000','40111000','40114000','40115000','40132000','17049010','18063110','18063120','18063210',"
  cQry += "'18063220','18069000','17049010','18069000','18069000','18069000','17049090','18069000','19011020','19011010','19011090',"
  cQry += "'19011030','04011010','04012010','04011010','04012010','04014010','04015010','04014010','04015010','04011090','04012090',"
  cQry += "'04011090','04012090','04022130','04022930','04022130','04022930','04022920','04039000','04051000','04051000','15171000',"
  cQry += "'15171000','15171000','15162000','15162000','19019020','19041000','19049000','19059090','20052000','21032010','21039021',"
  cQry += "'21039091','21031010','21033010','21033021','21039011','21032010','17049090','19042000','19049000','18063120','18063220',"
  cQry += "'18069000','11010010','11010010','11010020','19012000','19019090','19023000','19024000','19052090','19052010','19059020',"
  cQry += "'19059010','19059020','19059090','19051000','15079011','15100000','15121911','15122910','15151900','15152910','15122990',"
  cQry += "'15179010','16010000','16010000','16010000','02102000','02109900','02109900','15021019','15029000','02109900','20060000',"
  cQry += "'20060000','12119090','21069090','17019900','17019900','17019900','17019100','17019100','17019100','17019900','17019900',"
  cQry += "'17019900','17019100','17019100','17019900','17019900','17019900','17019100','17019100','17019100','20081900','19019090',"
  cQry += "'21011190','21011200','69111010','69111090','69120000','69120000','32131000','39162000','39161000','39261000','39269090',"
  cQry += "'48022090','48119090','48025499','48025799','48162000','37031010','37031029','37032000','37039010','37040000','48022000',"
  cQry += "'48101390','48169010','39202019','48062000','48081000','48102290','48201000','48202000','48203000','48204000','48205000',"
  cQry += "'48209000','49090000','96081000','96082000','96083000','52105990','76071190','12119090','12119090','27121000','28142000',"
  cQry += "'28470000','30067000','33030010','33030020','33041000','33042010','33042090','33043000','33049100','33049910','33049990',"
  cQry += "'33049990','33051000','33052000','33053000','33059000','33059000','33059000','33061000','33062000','33069000','33071000',"
  cQry += "'33072010','33072010','33072090','33072090','33073000','33079000','33079000','34011190','34011900','34012010','34013000',"
  cQry += "'40149010','40149090','39249000','39269040','39269090','48181000','48181000','48182000','48182000','48183000','48189090'," 
  cQry += "'96190000','96190000','96190000','56012190','56039290','82032090','82141000','82142000','90251110','90251990','96032100',"
  cQry += "'96033000','96050000','96162000','39233000','39249000','39241000','40149090','70102000','82121020','82122010','73211100',"
  cQry += "'73218100','73219000','84181000','84182100','84182900','84183000','84184000','84186999','84189900','84211990','84186931',"
  cQry += "'84221100','84229010','84501100','84501200','84501900','84512100','84512990','84521000','84715010','84716090','85044010',"
  cQry += "'85044040','85078000','85098010','85161000','85164000','85165000','85166000','85166000','85167100','85167200','85169000',"
  cQry += "'85171100','85198190','85219010','85219090','85235110','85235200','85235200','85284929','85285920','85286100','85285120',"
  cQry += "'90064000','90189050','90191000','90328911','95045000','85176222','85176239','85176262','85177021','84145990','84146000',"
  cQry += "'84149020','84151011','84151019','84151090','84159010','84159020','84212100','84243010','84243090','84249090','84672100',"
  cQry += "'85163100','85163200','84796000','84159090','85258019','84231000','85318000','85414011','85414021','85414022','85437092',"
  cQry += "'32041700','87021000','87029090','87032100','87032210','87032290','87032310','87032390','87032410','87032490','87033210',"
  cQry += "'87033290','87033310','87033390','87042110','87042120','87042130','87042190','87043110','87043120','87043130','87043190',"
  cQry += "'70133700','70134290','33030010','33030020','33041000','33042010','33042090','33043000','33049100','33049910','33049990',"
  cQry += "'33049990','33051000','33052000','33059000','33059000','33071000','33072010','33072090','33079000','33079000','34011190',"
  cQry += "'34011900','34012010','34013000','48182000','82141000','82142000','96032900','96033000','96161000','96162000','39233000',"
  cQry += "'39249000','39241000','40149090','70102000','40149090','84139190','84149010','84149039','84212300','84212990','84241000',"
  cQry += "'84213100','84213920','84254200','84311010','84339090','84811000','84818092','85129000','85171213','85185000','85256010',"
  cQry += "'85272190','85219090','85291090','85340000','85361000','85362000','85442000','85443000','87169090','90303321','90318040',"
  cQry += "'91040000','94012000','94019090','96138000','45049000','68129910','48234000','39191000','39199000','87082999','84123110',"
  cQry += "'84131900','84135090','84138100','84136019','84137010','84145910','84145990','84213990','85011019','85013110','85045000',"
  cQry += "'85123000','90271000','40081100','56012219','57032000','57033000','59119000','69039099','70072900','73145000','73151100',"
  cQry += "'73151210','84189900','84249090','84254910','84314100','85016100','85311090','90141000','90251990','90259010')"
  TCSQLExec(cQry)
  
  //- Adequação ao CEST
  cQry := "UPDATE "+RetSqlName("SB1")+" SET B1_TS='525' " 
  cQry += "WHERE D_E_L_E_T_ <> '*' "
  cQry += "AND B1_TS NOT IN('565','566') "
  cQry += "AND (B1_POSIPI LIKE '3917%' OR B1_POSIPI LIKE '40103%' OR B1_POSIPI LIKE '4823909%' OR B1_POSIPI LIKE '63061%' OR "
  cQry += "B1_POSIPI LIKE '6813%' OR B1_POSIPI LIKE '7320%' OR B1_POSIPI LIKE '7325%' OR B1_POSIPI LIKE '780600%' OR "
  cQry += "B1_POSIPI LIKE '830120%' OR B1_POSIPI LIKE '830160%' OR B1_POSIPI LIKE '830170%' OR B1_POSIPI LIKE '831000%' OR "
  cQry += "B1_POSIPI LIKE '84073%' OR B1_POSIPI LIKE '840820%' OR B1_POSIPI LIKE '84099%' OR B1_POSIPI LIKE '84122%' OR "
  cQry += "B1_POSIPI LIKE '841330%' OR B1_POSIPI LIKE '8414801%' OR B1_POSIPI LIKE '8414802%' OR B1_POSIPI LIKE '902690%' OR "
  cQry += "B1_POSIPI LIKE '871690%' OR B1_POSIPI LIKE '2205%' OR B1_POSIPI LIKE '220720%' OR B1_POSIPI LIKE '2205%' OR " 
  cQry += "B1_POSIPI LIKE '2205%' OR B1_POSIPI LIKE '220830%' OR B1_POSIPI LIKE '2205%' OR B1_POSIPI LIKE '2205%' OR "  
  cQry += "B1_POSIPI LIKE '2204%' OR B1_POSIPI LIKE '2205%' OR B1_POSIPI LIKE '2206%' OR B1_POSIPI LIKE '2207%' OR "
  cQry += "B1_POSIPI LIKE '2208%' OR B1_POSIPI LIKE '2202%' OR B1_POSIPI LIKE '2202%' OR B1_POSIPI LIKE '210120%' OR "
  cQry += "B1_POSIPI LIKE '2402%' OR B1_POSIPI LIKE '24031%' OR B1_POSIPI LIKE '2523%' OR B1_POSIPI LIKE '220710%' OR "
  cQry += "B1_POSIPI LIKE '2710192%' OR B1_POSIPI LIKE '2710193%' OR B1_POSIPI LIKE '2710199%' OR B1_POSIPI LIKE '27109%' OR "
  cQry += "B1_POSIPI LIKE '2711%' OR B1_POSIPI LIKE '2713%' OR B1_POSIPI LIKE '3403%' OR B1_POSIPI LIKE '6804%' OR "
  cQry += "B1_POSIPI LIKE '8201%' OR B1_POSIPI LIKE '8202%' OR B1_POSIPI LIKE '8203%' OR B1_POSIPI LIKE '8204%' OR "
  cQry += "B1_POSIPI LIKE '8205%' OR B1_POSIPI LIKE '8206%' OR B1_POSIPI LIKE '820740%' OR B1_POSIPI LIKE '820760%' OR " 
  cQry += "B1_POSIPI LIKE '820770%' OR B1_POSIPI LIKE '8207%' OR B1_POSIPI LIKE '8208%' OR B1_POSIPI LIKE '8209%' OR "
  cQry += "B1_POSIPI LIKE '8211%' OR B1_POSIPI LIKE '8213%' OR B1_POSIPI LIKE '8467%' OR B1_POSIPI LIKE '9015%' OR "
  cQry += "B1_POSIPI LIKE '901730%' OR B1_POSIPI LIKE '901780%' OR B1_POSIPI LIKE '902519%' OR B1_POSIPI LIKE '8539%' OR "
  cQry += "B1_POSIPI LIKE '8540%' OR B1_POSIPI LIKE '853650%' OR B1_POSIPI LIKE '2522%' OR B1_POSIPI LIKE '3816001%' OR "
  cQry += "B1_POSIPI LIKE '391000%' OR B1_POSIPI LIKE '3916%' OR B1_POSIPI LIKE '3917%' OR B1_POSIPI LIKE '3918%' OR "
  cQry += "B1_POSIPI LIKE '3919%' OR B1_POSIPI LIKE '3919%' OR B1_POSIPI LIKE '3920%' OR B1_POSIPI LIKE '3921%' OR "
  cQry += "B1_POSIPI LIKE '3921%' OR B1_POSIPI LIKE '3921%' OR B1_POSIPI LIKE '3921%' OR B1_POSIPI LIKE '3922%' OR "
  cQry += "B1_POSIPI LIKE '3924%' OR B1_POSIPI LIKE '392590%' OR B1_POSIPI LIKE '392590%' OR B1_POSIPI LIKE '392690%' OR "
  cQry += "B1_POSIPI LIKE '4814%' OR B1_POSIPI LIKE '6811%' OR B1_POSIPI LIKE '6811%' OR B1_POSIPI LIKE '6902%' OR "
  cQry += "B1_POSIPI LIKE '6904%' OR B1_POSIPI LIKE '6905%' OR B1_POSIPI LIKE '6907%' OR B1_POSIPI LIKE '6908%' OR "
  cQry += "B1_POSIPI LIKE '6907%' OR B1_POSIPI LIKE '6908%' OR B1_POSIPI LIKE '6910%' OR B1_POSIPI LIKE '7003%' OR "
  cQry += "B1_POSIPI LIKE '7004%' OR B1_POSIPI LIKE '7005%' OR B1_POSIPI LIKE '7008%' OR B1_POSIPI LIKE '7016%' OR "
  cQry += "B1_POSIPI LIKE '7213%' OR B1_POSIPI LIKE '7312%' OR B1_POSIPI LIKE '721720%' OR B1_POSIPI LIKE '7307%' OR "
  cQry += "B1_POSIPI LIKE '730890%' OR B1_POSIPI LIKE '7310%' OR B1_POSIPI LIKE '7314%' OR B1_POSIPI LIKE '731700%' OR "
  cQry += "B1_POSIPI LIKE '7318%' OR B1_POSIPI LIKE '7323%' OR B1_POSIPI LIKE '7324%' OR B1_POSIPI LIKE '7325%' OR "
  cQry += "B1_POSIPI LIKE '7326%' OR B1_POSIPI LIKE '7407%' OR B1_POSIPI LIKE '7412%' OR B1_POSIPI LIKE '7415%' OR "
  cQry += "B1_POSIPI LIKE '7608%' OR B1_POSIPI LIKE '7610%' OR B1_POSIPI LIKE '7616%' OR B1_POSIPI LIKE '8301%' OR "
  cQry += "B1_POSIPI LIKE '8307%' OR B1_POSIPI LIKE '8311%' OR B1_POSIPI LIKE '8481%' OR B1_POSIPI LIKE '3402%' OR "
  cQry += "B1_POSIPI LIKE '2207%' OR B1_POSIPI LIKE '8516%' OR B1_POSIPI LIKE '8535%' OR B1_POSIPI LIKE '8504%' OR "
  cQry += "B1_POSIPI LIKE '8536%' OR B1_POSIPI LIKE '8538%' OR B1_POSIPI LIKE '8544%' OR B1_POSIPI LIKE '7605%' OR "
  cQry += "B1_POSIPI LIKE '7614%' OR B1_POSIPI LIKE '8546%' OR B1_POSIPI LIKE '8547%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR "
  cQry += "B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '3003%' OR B1_POSIPI LIKE '3004%' OR B1_POSIPI LIKE '2936%' OR "
  cQry += "B1_POSIPI LIKE '300630%' OR B1_POSIPI LIKE '300630%' OR B1_POSIPI LIKE '3002%' OR B1_POSIPI LIKE '3002%' OR "
  cQry += "B1_POSIPI LIKE '3002%' OR B1_POSIPI LIKE '3002%' OR B1_POSIPI LIKE '3005%' OR B1_POSIPI LIKE '3005%' OR "
  cQry += "B1_POSIPI LIKE '901831%' OR B1_POSIPI LIKE '9018321%' OR B1_POSIPI LIKE '4823209%' OR B1_POSIPI LIKE '48236%' OR "
  cQry += "B1_POSIPI LIKE '3919%' OR B1_POSIPI LIKE '3920%' OR B1_POSIPI LIKE '3921%' OR B1_POSIPI LIKE '3924%' OR "
  cQry += "B1_POSIPI LIKE '39232%' OR B1_POSIPI LIKE '4011%' OR B1_POSIPI LIKE '4011%' OR B1_POSIPI LIKE '40121%' OR "
  cQry += "B1_POSIPI LIKE '401290%' OR B1_POSIPI LIKE '401290%' OR B1_POSIPI LIKE '4013%' OR B1_POSIPI LIKE '2009%' OR "
  cQry += "B1_POSIPI LIKE '20098%' OR B1_POSIPI LIKE '04021%' OR B1_POSIPI LIKE '04022%' OR B1_POSIPI LIKE '04029%' OR "
  cQry += "B1_POSIPI LIKE '0401402%' OR B1_POSIPI LIKE '04029%' OR B1_POSIPI LIKE '0401402%' OR B1_POSIPI LIKE '04029%' OR "
  cQry += "B1_POSIPI LIKE '040110%' OR B1_POSIPI LIKE '040120%' OR B1_POSIPI LIKE '040150%' OR B1_POSIPI LIKE '040210%' OR "
  cQry += "B1_POSIPI LIKE '04029%' OR B1_POSIPI LIKE '04029%' OR B1_POSIPI LIKE '0403%' OR B1_POSIPI LIKE '0403%' OR "
  cQry += "B1_POSIPI LIKE '0406%' OR B1_POSIPI LIKE '0406%' OR B1_POSIPI LIKE '0406%' OR B1_POSIPI LIKE '151790%' OR "
  cQry += "B1_POSIPI LIKE '20059%' OR B1_POSIPI LIKE '20081%' OR B1_POSIPI LIKE '20081%' OR B1_POSIPI LIKE '2002%' OR "
  cQry += "B1_POSIPI LIKE '1902%' OR B1_POSIPI LIKE '19021%' OR B1_POSIPI LIKE '190520%' OR B1_POSIPI LIKE '190531%' OR "
  cQry += "B1_POSIPI LIKE '190531%' OR B1_POSIPI LIKE '190531%' OR B1_POSIPI LIKE '190532%' OR B1_POSIPI LIKE '190532%' OR "
  cQry += "B1_POSIPI LIKE '190540%' OR B1_POSIPI LIKE '190590%' OR B1_POSIPI LIKE '1508%' OR B1_POSIPI LIKE '1509%' OR "
  cQry += "B1_POSIPI LIKE '1509%' OR B1_POSIPI LIKE '1509%' OR B1_POSIPI LIKE '15141%' OR B1_POSIPI LIKE '1511%' OR "
  cQry += "B1_POSIPI LIKE '1513%' OR B1_POSIPI LIKE '1514%' OR B1_POSIPI LIKE '1515%' OR B1_POSIPI LIKE '1516%' OR "
  cQry += "B1_POSIPI LIKE '1518%' OR B1_POSIPI LIKE '1602%' OR B1_POSIPI LIKE '1604%' OR B1_POSIPI LIKE '1604%' OR "
  cQry += "B1_POSIPI LIKE '1605%' OR B1_POSIPI LIKE '0206%' OR B1_POSIPI LIKE '1502%' OR B1_POSIPI LIKE '0201%' OR "
  cQry += "B1_POSIPI LIKE '0202%' OR B1_POSIPI LIKE '204%' OR B1_POSIPI LIKE '204%' OR B1_POSIPI LIKE '0203%' OR "
  cQry += "B1_POSIPI LIKE '0206%' OR B1_POSIPI LIKE '0207%' OR B1_POSIPI LIKE '0209%' OR B1_POSIPI LIKE '02101%' OR "
  cQry += "B1_POSIPI LIKE '1501%' OR B1_POSIPI LIKE '710%' OR B1_POSIPI LIKE '710%' OR B1_POSIPI LIKE '811%' OR "
  cQry += "B1_POSIPI LIKE '811%' OR B1_POSIPI LIKE '2001%' OR B1_POSIPI LIKE '2001%' OR B1_POSIPI LIKE '2004%' OR "
  cQry += "B1_POSIPI LIKE '2004%' OR B1_POSIPI LIKE '2005%' OR B1_POSIPI LIKE '2005%' OR B1_POSIPI LIKE '2007%' OR "
  cQry += "B1_POSIPI LIKE '2007%' OR B1_POSIPI LIKE '2008%' OR B1_POSIPI LIKE '2008%' OR B1_POSIPI LIKE '901%' OR "
  cQry += "B1_POSIPI LIKE '901%' OR B1_POSIPI LIKE '0902%' OR B1_POSIPI LIKE '090300%' OR B1_POSIPI LIKE '17011%' OR "
  cQry += "B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '17011%' OR "
  cQry += "B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '170191%' OR B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '17011%' OR "
  cQry += "B1_POSIPI LIKE '17011%' OR B1_POSIPI LIKE '1702%' OR B1_POSIPI LIKE '1702%' OR B1_POSIPI LIKE '1702%' OR " 
  cQry += "B1_POSIPI LIKE '21011%' OR B1_POSIPI LIKE '210120%' OR B1_POSIPI LIKE '391690%' OR B1_POSIPI LIKE '42021%' OR "
  cQry += "B1_POSIPI LIKE '42029%' OR B1_POSIPI LIKE '4802549%' OR B1_POSIPI LIKE '4802569%' OR B1_POSIPI LIKE '4802579%' OR "
  cQry += "B1_POSIPI LIKE '4802589%' OR B1_POSIPI LIKE '4817%' OR B1_POSIPI LIKE '4809%' OR B1_POSIPI LIKE '4816%' OR "
  cQry += "B1_POSIPI LIKE '9608%' OR B1_POSIPI LIKE '480256%' OR B1_POSIPI LIKE '3301%' OR B1_POSIPI LIKE '42021%' OR "
  cQry += "B1_POSIPI LIKE '96032%' OR B1_POSIPI LIKE '9615%' OR B1_POSIPI LIKE '841850%' OR B1_POSIPI LIKE '8418699%' OR "
  cQry += "B1_POSIPI LIKE '842112%' OR B1_POSIPI LIKE '84219%' OR B1_POSIPI LIKE '844331%' OR B1_POSIPI LIKE '844332%' OR "
  cQry += "B1_POSIPI LIKE '84439%' OR B1_POSIPI LIKE '845020%' OR B1_POSIPI LIKE '845090%' OR B1_POSIPI LIKE '845190%' OR "
  cQry += "B1_POSIPI LIKE '847130%' OR B1_POSIPI LIKE '84714%' OR B1_POSIPI LIKE '8471605%' OR B1_POSIPI LIKE '847170%' OR "
  cQry += "B1_POSIPI LIKE '847190%' OR B1_POSIPI LIKE '847330%' OR B1_POSIPI LIKE '85043%' OR B1_POSIPI LIKE '8508%' OR "
  cQry += "B1_POSIPI LIKE '8509%' OR B1_POSIPI LIKE '851679%' OR B1_POSIPI LIKE '8517123%' OR B1_POSIPI LIKE '851712%' OR "
  cQry += "B1_POSIPI LIKE '8517189%' OR B1_POSIPI LIKE '8517625%' OR B1_POSIPI LIKE '8518%' OR B1_POSIPI LIKE '8519%' OR "
  cQry += "B1_POSIPI LIKE '8522%' OR B1_POSIPI LIKE '85271%' OR B1_POSIPI LIKE '8525802%' OR B1_POSIPI LIKE '85279%' OR "
  cQry += "B1_POSIPI LIKE '852869%' OR B1_POSIPI LIKE '85287%' OR B1_POSIPI LIKE '85287%' OR B1_POSIPI LIKE '85287%' OR "
  cQry += "B1_POSIPI LIKE '85287%' OR B1_POSIPI LIKE '85287%' OR B1_POSIPI LIKE '900610%' OR B1_POSIPI LIKE '8517621%' OR "
  cQry += "B1_POSIPI LIKE '8517624%' OR B1_POSIPI LIKE '8517629%' OR B1_POSIPI LIKE '821490%' OR B1_POSIPI LIKE '8510%' OR "
  cQry += "B1_POSIPI LIKE '84145%' OR B1_POSIPI LIKE '841510%' OR B1_POSIPI LIKE '84158%' OR B1_POSIPI LIKE '85162%' OR "
  cQry += "B1_POSIPI LIKE '8527%' OR B1_POSIPI LIKE '8540%' OR B1_POSIPI LIKE '8517%' OR B1_POSIPI LIKE '8517%' OR "
  cQry += "B1_POSIPI LIKE '8529%' OR B1_POSIPI LIKE '8531%' OR B1_POSIPI LIKE '853110%' OR B1_POSIPI LIKE '853400%' OR "
  cQry += "B1_POSIPI LIKE '90303%' OR B1_POSIPI LIKE '903089%' OR B1_POSIPI LIKE '910700%' OR B1_POSIPI LIKE '9405%' OR "
  cQry += "B1_POSIPI LIKE '2309%' OR B1_POSIPI LIKE '210500%' OR B1_POSIPI LIKE '1806%' OR B1_POSIPI LIKE '1901%' OR "
  cQry += "B1_POSIPI LIKE '2106%' OR B1_POSIPI LIKE '3208%' OR B1_POSIPI LIKE '3209%' OR B1_POSIPI LIKE '321000%' OR "
  cQry += "B1_POSIPI LIKE '2821%' OR B1_POSIPI LIKE '3206%' OR B1_POSIPI LIKE '8711%' OR B1_POSIPI LIKE '7009%' OR "
  cQry += "B1_POSIPI LIKE '7013%' OR B1_POSIPI LIKE '42021%' OR B1_POSIPI LIKE '9615%' OR B1_POSIPI LIKE '8414903%' OR "
  cQry += "B1_POSIPI LIKE '841520%' OR B1_POSIPI LIKE '84219%' OR B1_POSIPI LIKE '8431492%' OR B1_POSIPI LIKE '84812%' OR "
  cQry += "B1_POSIPI LIKE '8482%' OR B1_POSIPI LIKE '8483%' OR B1_POSIPI LIKE '8484%' OR B1_POSIPI LIKE '850520%' OR "
  cQry += "B1_POSIPI LIKE '850710%' OR B1_POSIPI LIKE '8511%' OR B1_POSIPI LIKE '851220%' OR B1_POSIPI LIKE '851240%' OR "
  cQry += "B1_POSIPI LIKE '8518%' OR B1_POSIPI LIKE '851981%' OR B1_POSIPI LIKE '8525501%' OR B1_POSIPI LIKE '85272%' OR "
  cQry += "B1_POSIPI LIKE '853530%' OR B1_POSIPI LIKE '853650%' OR B1_POSIPI LIKE '85364%' OR B1_POSIPI LIKE '8538%' OR "
  cQry += "B1_POSIPI LIKE '853910%' OR B1_POSIPI LIKE '85392%' OR B1_POSIPI LIKE '8707%' OR B1_POSIPI LIKE '8708%' OR "
  cQry += "B1_POSIPI LIKE '87141%' OR B1_POSIPI LIKE '902610%' OR B1_POSIPI LIKE '902620%' OR B1_POSIPI LIKE '9029%' OR "
  cQry += "B1_POSIPI LIKE '9032892%' OR B1_POSIPI LIKE '4009%' OR B1_POSIPI LIKE '850720%' OR B1_POSIPI LIKE '850730%' OR "
  cQry += "B1_POSIPI LIKE '9032898%' OR B1_POSIPI LIKE '9032899%' OR B1_POSIPI LIKE '841950%') " 
  TCSQLExec(cQry)

  //- Ajusta doc de entrada
  cQry := "UPDATE "+RetSqlName("SD1")+" SET D1_XNCM=B1_POSIPI "
  cQry += "FROM "+RetSqlName("SD1")+ " A,"+RetSqlName("SB1")+" B "
  cQry += "WHERE A.D_E_L_E_T_ <> '*' AND B.D_E_L_E_T_ <> '*' "  
  cQry += "AND B1_XNCMOK='1' "
  cQry += "AND D1_COD = B1_COD"  
  TCSQLExec(cQry)

  //- NCM com 08 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=8 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,8)=NCM " 
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)
	
  //- NCM com 07 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=7 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,7)=NCM " 
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)
	
  //-- NCM com 06 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=6 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,6)=NCM "
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)
	
  //-- NCM com 05 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=5 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,5)=NCM "
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)

  //-- NCM com 04 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=4 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,4)=NCM "
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)

  //-- NCM com 03 Caracteres
  cQry := "UPDATE SB1010 SET B1_CEST=CEST "
  cQry += "FROM SB1010,TAB_CEST "
  cQry += "WHERE D_E_L_E_T_ <> '*' AND LEN(NCM)=3 "
  cQry += "AND SUBSTRING(B1_POSIPI,1,3)=NCM " 
  cQry += "AND B1_CEST='' "
  TCSQLExec(cQry)
  
  conout("Saiu!!!")         

  RESET ENVIRONMENT
  
Return